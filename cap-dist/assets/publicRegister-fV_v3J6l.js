import"./modulepreload-polyfill-B5Qt9EMX.js";const I="pk_test_51STpHSAIZNC4mWLrbapCgFGi2o6tMg07vyFa22LKwGOpN4nNdO0KzB6S4ioHsz4YiQXWrFPn8dVuYgkl0xnCHl2l000K2JtygR",y=Stripe(I),h=y.elements(),x={base:{color:"#ffffff",fontFamily:'"Inter", sans-serif',fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#94a3b8"}},invalid:{color:"#f87171",iconColor:"#f87171"}},g=h.create("card",{style:x,hidePostalCode:!0});g.mount("#card-element");const b=new URLSearchParams(window.location.search),u=b.get("planId"),w={lancamento_mensal:85.9,lancamento_semestral:438.09,lancamento_anual:721.56};document.addEventListener("DOMContentLoaded",()=>{const e=new Date,t=new Date(e);t.setDate(e.getDate()+7);const o=t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}),a=document.getElementById("charge-date-display");if(a&&(a.innerText=o),!u){alert("Nenhum plano selecionado."),window.location.href="index.html#planos";return}v(u)});function v(e){const t=document.getElementById("plan-price-val"),o=document.getElementById("plan-name-display"),a=document.getElementById("plan-period-text"),s=document.getElementById("installments-wrapper"),i=document.getElementById("installmentsCount");let l=w[e]||0,n=1;if(e.includes("mensal")?(o.innerText="Plano Unlimited - Mensal",t.innerText="R$ 85,90",a.innerText="/mês",s.classList.remove("visible"),n=1):e.includes("semestral")?(o.innerText="Plano Unlimited - Semestral",t.innerText="R$ 438,09",a.innerText="/semestre",s.classList.add("visible"),n=6):e.includes("anual")&&(o.innerText="Plano Unlimited - Anual",t.innerText="R$ 721,56",a.innerText="/ano",s.classList.add("visible"),n=12),n>1){i.innerHTML="";const m=document.createElement("option");m.value=1,m.text=`1x de R$ ${l.toFixed(2).replace(".",",")} (À vista)`,i.add(m);for(let r=2;r<=n;r++){let E=l/r;const c=document.createElement("option");c.value=r,c.text=`${r}x de R$ ${E.toFixed(2).replace(".",",")} sem juros`,i.add(c)}i.value=n}}const B=document.getElementById("register-form"),d=document.getElementById("submit-button"),f=document.getElementById("btn-text");B.addEventListener("submit",async e=>{e.preventDefault(),d.disabled=!0,f.innerText="Criando sua conta...";const t=d.querySelector(".loader");t&&(t.style.display="inline-block");const o=parseInt(document.getElementById("installmentsCount").value)||1,{paymentMethod:a,error:s}=await y.createPaymentMethod({type:"card",card:g,billing_details:{name:document.getElementById("establishmentName").value,email:document.getElementById("ownerEmail").value}});if(s){document.getElementById("card-errors").textContent=s.message,p();return}const i={establishmentName:document.getElementById("establishmentName").value,establishmentId:document.getElementById("establishmentId").value,ownerEmail:document.getElementById("ownerEmail").value,ownerPassword:document.getElementById("ownerPassword").value,planId:u,paymentMethodId:a.id,installments:o,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone};try{const l=await fetch("https://kairos-app-407358446276.us-central1.run.app/api/public/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),n=await l.json();if(l.ok)window.location.href=n.loginUrl||"login.html";else throw new Error(n.message||"Erro ao criar conta.")}catch(l){alert("Erro: "+l.message),p()}});function p(){d.disabled=!1,f.innerText="Começar Teste Grátis de 7 Dias";const e=d.querySelector(".loader");e&&(e.style.display="none")}
